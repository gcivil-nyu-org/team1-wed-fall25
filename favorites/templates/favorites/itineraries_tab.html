{% if itineraries %}
    <div class="itineraries-grid">
        {% for itinerary in itineraries %}
            <div class="itinerary-card">
                <div class="itinerary-header">
                    <h3 class="itinerary-title">
                        <a href="{% url 'itineraries:detail' itinerary.pk %}">
                            {{ itinerary.title }}
                        </a>
                        <span class="badge bg-warning text-dark" style="padding: 6px 12px; border-radius: 20px; font-size: 0.85rem;">
                            <i class="fas fa-star"></i>
                        </span>
                    </h3>
                </div>
                
                <div class="itinerary-body">
                    {% if itinerary.description %}
                        <p style="color: #666; margin-bottom: 15px;">{{ itinerary.description|truncatewords:20 }}</p>
                    {% endif %}

                    <div class="itinerary-meta">
                        <div>
                            <i class="fas fa-map-marker-alt" style="width: 20px; color: #667eea;"></i>
                            {{ itinerary.stops.count }} stop{{ itinerary.stops.count|pluralize }}
                        </div>
                        
                        {% if itinerary.date %}
                        <div>
                            <i class="fas fa-calendar" style="width: 20px; color: #667eea;"></i>
                            Planned for {{ itinerary.date|date:"M d, Y" }}
                        </div>
                        {% endif %}
                        
                        <div>
                            <i class="fas fa-user" style="width: 20px; color: #667eea;"></i>
                            By {{ itinerary.user.username }}
                        </div>

                        <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #e0e0e0; color: #999; font-size: 0.9rem;">
                            <i class="fas fa-heart" style="width: 20px;"></i>
                            Favorited {{ itinerary.favorited_at|date:"M d, Y" }}
                        </div>
                    </div>

                    {% if itinerary.stops.all %}
                    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #e0e0e0;">
                        <small style="color: #666; font-weight: 600;">Stops:</small>
                        <ol style="margin: 10px 0 0 0; padding-left: 20px; font-size: 0.9rem;">
                            {% for stop in itinerary.stops.all|slice:":3" %}
                            <li style="margin-bottom: 5px;">
                                {{ stop.location.title|default:"Untitled"|truncatewords:8 }}
                                {% if stop.visit_time %}
                                <span style="color: #999;">at {{ stop.visit_time|time:"g:i A" }}</span>
                                {% endif %}
                            </li>
                            {% endfor %}
                            {% if itinerary.stops.count > 3 %}
                            <li style="color: #999;">+ {{ itinerary.stops.count|add:"-3" }} more...</li>
                            {% endif %}
                        </ol>
                    </div>
                    {% endif %}

                    <div class="action-buttons">
                        <a href="{% url 'itineraries:detail' itinerary.pk %}" class="btn btn-primary">
                            <i class="fas fa-eye"></i> View Itinerary
                        </a>
                        <form method="post" action="{% url 'itineraries:unfavorite' itinerary.pk %}" style="display: inline;">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-warning">
                                <i class="fas fa-star"></i> Unfavorite
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <div class="empty-state">
        <i class="fas fa-route"></i>
        <h3>No Favorite Itineraries Yet</h3>
        <p>Start exploring itineraries and add them to your favorites!</p>
        <a href="{% url 'itineraries:list' %}" class="btn btn-primary">Browse Itineraries</a>
    </div>
{% endif %}
