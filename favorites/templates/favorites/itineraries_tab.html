{% if itineraries %}
    <div class="content-grid">
        {% for itinerary in itineraries %}
            <a class="content-card" href="{% url 'itineraries:detail' itinerary.pk %}">
                <div class="art-card-header">
                    <h3 class="itinerary-title">{{ itinerary.title }}</h3>
                </div>
                
                <div class="itinerary-body">
                    {% if itinerary.description %}
                        <p>{{ itinerary.description|truncatewords:20 }}</p>
                    {% endif %}

                    <div class="itinerary-meta">
                        <div>
                            <i class="fas fa-map-marker-alt"></i>
                            {{ itinerary.stops.count }} stop{{ itinerary.stops.count|pluralize }}
                        </div>
                        
                        {% if itinerary.date %}
                        <div>
                            <i class="fas fa-calendar"></i>
                            Planned for {{ itinerary.date|date:"M d, Y" }}
                        </div>
                        {% endif %}
                        
                        <div>
                            <i class="fas fa-user"></i>
                            By {{ itinerary.user.username }}
                        </div>

                        <div>
                            <i class="fas fa-heart"></i>
                            Favorited {{ itinerary.favorited_at|date:"M d, Y" }}
                        </div>
                    </div>

                    {% if itinerary.stops.all %}
                    <div>
                        <small>Stops:</small>
                        <ol>
                            {% for stop in itinerary.stops.all|slice:":3" %}
                            <li>
                                {{ stop.location.title|default:"Untitled"|truncatewords:8 }}
                                {% if stop.visit_time %}
                                <span>at {{ stop.visit_time|time:"g:i A" }}</span>
                                {% endif %}
                            </li>
                            {% endfor %}
                            {% if itinerary.stops.count > 3 %}
                            <li>+ {{ itinerary.stops.count|add:"-3" }} more...</li>
                            {% endif %}
                        </ol>
                    </div>
                    {% endif %}

                    <div class="action-buttons">
                        <form method="post" action="{% url 'itineraries:unfavorite' itinerary.pk %}" style="display: inline;">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-outline-primary">
                                <i class="fas fa-heart favorited"></i>
                            </button>
                        </form>
                        <span class="btn btn-outline-primary">
                            <i class="fas fa-eye"></i> View
                        </span>
                    </div>
                </div>
            </a>
        {% endfor %}
    </div>
{% else %}
    <div class="empty-state">
        <i class="fas fa-route"></i>
        <h3>No Favorite Itineraries Yet</h3>
        <p>Start exploring itineraries and add them to your favorites!</p>
        <a href="{% url 'itineraries:list' %}" class="btn btn-primary">Browse Itineraries</a>
    </div>
{% endif %}
